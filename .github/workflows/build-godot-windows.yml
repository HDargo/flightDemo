name: Build Godot 4 (Windows)

on:
  push:
    branches: [ "main" ]
  pull_request:

jobs:
  build-windows:
    runs-on: windows-latest

    steps:
      - name: Checkout Godot source
        uses: actions/checkout@v4

      # Python & SCons 설치
      - name: Install SCons
        run: |
          python -m pip install --upgrade pip
          pip install scons==4.4.0

      # MSVC 개발 환경 설정 (Godot 4는 MSVC 권장)
      - name: Setup MSVC
        uses: ilammy/msvc-dev-cmd@v1
        with:
          arch: x64

      # 실제 빌드
      - name: Build Windows Editor
        run: |
          scons platform=windows target=editor vsproj=no production=yes debug_symbols=no -j4

      # 결과물 업로드
      - name: Upload artifact (Editor)
        uses: actions/upload-artifact@v4
        with:
          name: godot-windows-editor
          path: bin/godot.windows.editor.x86_64.exe
